<!DOCTYPE html>
<html lang="en-US">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Apply google sheets custom form</title>
    <base target="_top" />

  </head>
<body>
<p>hello world! I figured it out!
</p>
    <form>
      Your name: <input type="text" name="Name" /><br />
      Your email: <input type="email" name="Email" /><br />

      <input
        type="submit"
        name="button"
        value="submit"
        onclick="run(this);return false;"
      />
    </form>
  
  <script src="https://cdn.jsdelivr.net/gh/tanaikech/HtmlFormObjectParserForGoogleAppsScript_js/htmlFormObjectParserForGoogleAppsScript_js.min.js"></script>
  <script>
    async function run(e) {
      const url = "https://script.google.com/macros/s/AKfycbzWSSTg-Wd-XQOmMNFHQ9LYU5gMCUJW-cjhvRqopQjvNWb49ae5ggYS0nWGOMuEggF7/exec"; // Please set your Web Apps URL here.
      const obj = await ParseFormObjectForGAS(e.parentNode, null, null, true);
      fetch(url, { method: "POST", body: JSON.stringify(obj) })
        .then((res) => res.json())
        .then((res) => console.log(res));
    button.value = "Submitting...";
    button.classList.add("loading"); // Add a CSS class for spinner/animation
    button.disabled = true;

    // ...submission logic...

    // On completion, reset as needed
    button.value = "Submit";
    button.classList.remove("loading");
    button.disabled = false;
    }
  </script>
</body>
</html>